---
title: state pattern
date: 2021-03-21 13:03:24
category: design pattern
tags: [design pattern]
draft: false
---

## ë””ìì¸ íŒ¨í„´ì´ë€?

- ë°˜ë³µì ìœ¼ë¡œ ë‚˜íƒ€ë‚œ ë¬¸ì œì— ëŒ€í•´ ê·¸ê²ƒì„ í•´ê²°í•œ ê²½í—˜ ë° ë…¸í•˜ìš°ë¥¼ ì¶•ì í•˜ì—¬ `ì¬ì‚¬ìš©í•˜ê¸° ì¢‹ì€ í˜•íƒœë¡œ` ì´ë¦„ì„ ë¶™ì—¬ `í•´ë²•ì„ ì œì‹œí•˜ëŠ” íŒ¨í„´`ì–‘ì‹ ì…ë‹ˆë‹¤.
- ë””ìì¸ íŒ¨í„´ì€ í¬ê²Œ 3ê°€ì§€ ë¶„ë¥˜ê°€ ìˆìŠµë‹ˆë‹¤.
  - ìƒì„± íŒ¨í„´ : ê°ì²´ ìƒì„±ê³¼ ê´€ë ¨ëœ íŒ¨í„´
  - êµ¬ì¡° íŒ¨í„´ : í´ë˜ìŠ¤ë‚˜ ê°ì²´ë¥¼ ì¡°í•©í•´ ë” í° êµ¬ì¡°ë¥¼ ë§Œë“œëŠ” íŒ¨í„´
  - í–‰ìœ„ íŒ¨í„´ : ê°ì²´ë‚˜ í´ë˜ìŠ¤ ì‚¬ì´ì˜ ì•Œê³ ë¦¬ì¦˜ì´ë‚˜ ì±…ì„ ë¶„ë°°ì— ê´€ë ¨ëœ íŒ¨í„´

## í–‰ìœ„ ì†Œí”„íŠ¸ì›¨ì–´ ë””ìì¸ íŒ¨í„´

- ìƒíƒœ íŒ¨í„´(state pattern)ì€ ê°ì²´ ì§€í–¥ ë°©ì‹ìœ¼ë¡œ ìƒíƒœ ê¸°ê³„ë¥¼ êµ¬í˜„í•˜ëŠ” `í–‰ìœ„` ì†Œí”„íŠ¸ì›¨ì–´ ë””ìì¸ íŒ¨í„´ì…ë‹ˆë‹¤.

## ë³€í•˜ëŠ” ê²ƒì€ ì˜ ë³€í•˜ì§€ ì•ŠëŠ” ê²ƒê³¼ ë¶„ë¦¬í•´ë¼. ì¦‰, ë³€í•˜ëŠ” ë…€ì„ë“¤ì„ ìº¡ìŠí™”í•´ë¼!

- ìŠ¤í…Œì´íŠ¸ íŒ¨í„´ì€ ê°ì²´ê°€ `íŠ¹ì • ìƒíƒœì— ë”°ë¼ í–‰ìœ„ë¥¼ ë‹¬ë¦¬í•˜ëŠ” ìƒí™©`ì—ì„œ `ìì‹ ì´ ì§ì ‘ ìƒíƒœë¥¼ ì²´í¬í•˜ì—¬ ìƒíƒœì— ë”°ë¼ í–‰ìœ„ë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šê³ ` ìƒíƒœë¥¼ `ê°ì²´í™”`í•˜ì—¬ `ìƒíƒœê°€ í–‰ë™ì„ í•  ìˆ˜ ìˆë„ë¡ ìœ„ì„í•˜ëŠ” íŒ¨í„´`ì…ë‹ˆë‹¤.
- ê°ì²´ì˜ ë‚´ë¶€ ìƒíƒœì— ë”°ë¼ ìŠ¤ìŠ¤ë¡œ í–‰ë™ì„ ë³€ê²½í•  ìˆ˜ ìˆê²Œ í—ˆê°€í•˜ëŠ” íŒ¨í„´ìœ¼ë¡œ, ì´ë ‡ê²Œ í•˜ë©´ `ê°ì²´ëŠ” ë§ˆì¹˜ ìì‹ ì˜ í´ë˜ìŠ¤ë¥¼ ë°”ê¾¸ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì…ë‹ˆë‹¤`.
- ìƒíƒœ íŒ¨í„´ì„ ì´ìš©í•˜ë©´ ìƒíƒœ íŒ¨í„´ ì¸í„°í˜ì´ìŠ¤ì˜ íŒŒìƒ í´ë˜ìŠ¤ë¡œ ê°ê°ì˜ ìƒíƒœë¥¼ êµ¬í˜„í•¨ìœ¼ë¡œì¨, ë˜ íŒ¨í„´ì˜ ìŠˆí¼í´ë˜ìŠ¤ì— ì˜í•´ ì •ì˜ë˜ëŠ” ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ì—¬ ìƒíƒœ ë³€í™”ë¥¼ êµ¬í˜„í•¨ìœ¼ë¡œì¨ ìƒíƒœ ê¸°ê³„ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤.
- ê°ì²´ì˜ íŠ¹ì • `ìƒíƒœë¥¼ í´ë˜ìŠ¤ë¡œ ì„ ì–¸`í•˜ê³ , í´ë˜ìŠ¤ì—ì„œëŠ” `í•´ë‹¹ ìƒíƒœì—ì„œ í•  ìˆ˜ ìˆëŠ” í–‰ìœ„ë“¤ì„ ë©”ì„œë“œë¡œ ì •ì˜`í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ì´ëŸ¬í•œ `ê° ìƒíƒœ í´ë˜ìŠ¤ë“¤ì„ ì¸í„°í˜ì´ìŠ¤ë¡œ ìº¡ìŠí™”` í•˜ì—¬, `í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì¸í„°í˜ì´ìŠ¤ë¥¼ í˜¸ì¶œ`í•˜ëŠ” ë°©ì‹ì„ ë§í•©ë‹ˆë‹¤.
- êµ¬ì²´ì ì¸ ìƒíƒœ í´ë˜ìŠ¤ê°€ ì•„ë‹Œ ì¶”ìƒí™”ëœ State ì¸í„°í˜ì´ìŠ¤ë§Œ ì°¸ì¡°í•˜ë¯€ë¡œ `í˜„ì¬ ì–´ë–¤ ìƒíƒœì— ìˆëŠ”ì§€ì™€ ë¬´ê´€í•˜ê²Œ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤`.
- ìƒíƒœ ì „í™˜ì€ State í´ë˜ìŠ¤ì— ì˜í•´ì„œ ì œì–´í•  ìˆ˜ë„ ìˆê³ , Context í´ë˜ìŠ¤ì— ì˜í•´ì„œ ì œì–´í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
- State í´ë˜ìŠ¤ë¥¼ ì—¬ëŸ¬ Context ê°ì²´ì˜ ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ê³µìœ í•˜ë„ë¡ ë””ìì¸í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

## ì‹±ê¸€í†¤ì„ ì´ìš©í•˜ëŠ” ì´ìœ 

- ê° ìƒíƒœë“¤ì˜ êµ¬í˜„ì²´ì—ì„œ ì¡°ê¸ˆ íŠ¹ì´í•œ ê²ƒì€ ê° ìƒíƒœì˜ êµ¬í˜„ì²´ë“¤ì´ `ì‹±ê¸€í†¤`ìœ¼ë¡œ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ê²ƒì€ ìƒíƒœë“¤ì´ í–‰ìœ„ë¥¼ ìˆ˜í–‰í•˜ë©´ì„œ ê°ì²´ì˜ ìƒíƒœë¥¼ `ìˆ˜ì‹œë¡œ ë°”ê¾¸ì–´ì£¼ê¸° ë•Œë¬¸`ì— ì‹±ê¸€í†¤ìœ¼ë¡œ ì‘ì„±í•˜ì§€ ì•Šìœ¼ë©´ `ë§¤ë²ˆ ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒê²¨` ë¶ˆí•„ìš”í•œ ë©”ëª¨ë¦¬ë¥¼ ì¡ì•„ ë¨¹ì„ ê²ƒì´ê³  ì „ì²´ì ìœ¼ë¡œ ì„±ëŠ¥ ì €í•˜ì˜ ì›ì¸ì´ ë  ê²ƒì´ê¸° ë•Œë¬¸ì— ì‹±ê¸€í†¤ìœ¼ë¡œ ì‘ì„±í•©ë‹ˆë‹¤.

## ìœ í•œ ìƒíƒœ ê¸°ê³„(FSM)ë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- FSMì€ ì»´í“¨í„° ê³¼í•™ ë¶„ì•¼ ì¤‘ì˜ í•˜ë‚˜ì¸ ì˜¤í† ë§ˆíƒ€ ì´ë¡ ì—ì„œ ë‚˜ì™”ìŠµë‹ˆë‹¤.
- ê°€ì§ˆ ìˆ˜ ìˆëŠ” `ìƒíƒœ`ê°€ í•œì •ë©ë‹ˆë‹¤.
- í•œ ë²ˆì— `í•œ ê°€ì§€` ìƒíƒœë§Œ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- `ì…ë ¥`ì´ë‚˜ `ì´ë²¤íŠ¸`ê°€ ê¸°ê³„ì— ì „ë‹¬ë©ë‹ˆë‹¤.
- ê° ìƒíƒœì—ëŠ” ì…ë ¥ì— ë”°ë¼ ë‹¤ìŒ ìƒíƒœë¡œ ë°”ë€ŒëŠ” `ì „ì´`ê°€ ìˆìŠµë‹ˆë‹¤.

## ì¥ì 

- ê° ìƒíƒœë¥¼ í´ë˜ìŠ¤ë¡œ `ìº¡ìŠí™”`í•¨ìœ¼ë¡œì¨ ë‚˜ì¤‘ì— ë³€ê²½ì‹œì¼œì•¼ í•˜ëŠ” ë‚´ìš©ì„ êµ­ì§€í™”ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- í•˜ë‚˜ì˜ ê°ì²´ì— ëŒ€í•œ ì—¬ëŸ¬ ë™ì‘ì„ êµ¬í˜„í•´ì•¼í•  ë•Œ ìƒíƒœ ê°ì²´ë§Œ ìˆ˜ì •í•˜ë¯€ë¡œ ë™ì‘ì˜ ì¶”ê°€, ì‚­ì œ ë° ìˆ˜ì •ì´ ê°„ë‹¨í•´ì§‘ë‹ˆë‹¤.
- State íŒ¨í„´ì„ ì‚¬ìš©í•˜ë©´ ê°ì²´ì˜ ìƒíƒœì— ë”°ë¥¸ ì¡°ê±´ë¬¸(if/else, switch)ì´ ì¤„ì–´ë“¤ì–´ ì½”ë“œê°€ ê°„ê²°í•´ì§€ê³  ê°€ë…ì„±ì´ ì˜¬ë¼ê°‘ë‹ˆë‹¤.
- ìƒíƒœ ë³€ê²½ì— ë”°ë¥¸ í–‰ìœ„ ë¡œì§ì„ ì§ì ‘ êµ¬í˜„ í•˜ì§€ ì•Šì•„ë„ ë¨ìœ¼ë¡œì¨ í™•ì¥ì— ìœ ë¦¬í•˜ë‹¤.

## ë‹¨ì 

- ìƒíƒœì— ë”°ë¥¸ ì¡°ê±´ë¬¸ì„ ëŒ€ì‹ í•œ ìƒíƒœ ê°ì²´ê°€ ì¦ê°€í•˜ì—¬ ê´€ë¦¬í•´ì•¼í•  í´ë˜ìŠ¤ì˜ ìˆ˜ê°€ ì¦ê°€í•©ë‹ˆë‹¤.

## ìŠ¤íŠ¸ë˜ì§€í‹° íŒ¨í„´ê³¼ì˜ ë¹„êµ

- ìƒíƒœ íŒ¨í„´ì€ íŒ¨í„´ì˜ ì¸í„°í˜ì´ìŠ¤ì— ì •ì˜ëœ `ë©”ì†Œë“œë“¤ì˜ í˜¸ì¶œì„ í†µí•´ í˜„ì¬ì˜ ì „ëµì„ ì „í™˜í•  ìˆ˜ ìˆëŠ” ì „ëµ íŒ¨í„´`ìœ¼ë¡œ í•´ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ìŠ¤íŠ¸ë˜í‹°ì§€ íŒ¨í„´ì—ì„œì™€ `ê°™ì€ ë‹¤ì´ì–´ê·¸ë¨`ì„ ì‚¬ìš©í•œë‹¤. í•˜ì§€ë§Œ ì´ ë‘ íŒ¨í„´ì€ ìš©ë„ì— ìˆì–´ì„œ ì°¨ì´ê°€ ìˆìŠµë‹ˆë‹¤.
  - ìŠ¤í…Œì´íŠ¸ íŒ¨í„´ì„ ì‚¬ìš©í•  ë•ŒëŠ” ì—¬ëŸ¬ ìƒíƒœ ê°ì²´ ì¤‘ `í•œ ê°ì²´ì—ì„œ ëª¨ë“  í–‰ë™ì„ ë§¡ê¸°ê²Œ ë©ë‹ˆë‹¤`. ê·¸ ê°ì²´ì˜ ë‚´ë¶€ ìƒíƒœì— ë”°ë¼ í˜„ì¬ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°ì²´ê°€ ë°”ë€Œê²Œ ë˜ê³ , ê·¸ ê²°ê³¼ë¡œ ì»¨í…ìŠ¤íŠ¸ ê°ì²´ì˜ í–‰ë™ë„ ìì—°ìŠ¤ëŸ½ê²Œ ë°”ë€Œê²Œ ë©ë‹ˆë‹¤. `í´ë¼ì´ì–¸íŠ¸ëŠ” ìƒíƒœ ê°ì²´ì— ëŒ€í•´ì„œ ê±°ì˜ ì•„ë¬´ê²ƒë„ ëª°ë¼ë„ ë©ë‹ˆë‹¤`.
  - ìŠ¤íŠ¸ë˜í‹°ì§€ íŒ¨í„´ì„ ì‚¬ìš©í•  ë•ŒëŠ” ì¼ë°˜ì ìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì»¨í…ìŠ¤íŠ¸ ê°ì²´í•œí…Œ `ì–´ë–¤ ì „ëµ ê°ì²´ë¥¼ ì‚¬ìš©í• ì§€ë¥¼ ì§€ì •í•´ ì¤ë‹ˆë‹¤`. ìŠ¤íŠ¸ë˜í‹°ì§€ íŒ¨í„´ì€ ì£¼ë¡œ ì‹¤í–‰ì‹œì— ì „ëµ ê°ì²´ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆëŠ” `ìœ ì—°ì„±`ì„ ì œê³µí•˜ê¸° ìœ„í•œ ìš©ë„ë¡œ ì“°ì…ë‹ˆë‹¤. ë³´í†µ ê°€ì¥ ì í•©í•œ ì „ëµ ê°ì²´ë¥¼ ì„ íƒí•´ì„œ ì‚¬ìš©í•˜ê²Œ ë©ë‹ˆë‹¤.
  - ì¼ë°˜ì ìœ¼ë¡œ ìŠ¤íŠ¸ë˜í‹°ì§€ íŒ¨í„´ì€ ì„œë¸Œí´ë˜ìŠ¤ë¥¼ ë§Œë“œëŠ” ë°©ë²•ì„ ëŒ€ì‹ í•˜ì—¬ `ìœ ì—°ì„±`ì„ ê·¹ëŒ€í™”í•˜ê¸° ìœ„í•œ ìš©ë„ë¡œ ì“°ì…ë‹ˆë‹¤. ìƒì†ì„ ì´ìš©í•´ì„œ í´ë˜ìŠ¤ì˜ í–‰ë™ì„ ì •ì˜í•˜ë‹¤ ë³´ë©´ í–‰ë™ì„ ë³€ê²½í•´ì•¼ í•  ë•Œ ë§ˆìŒëŒ€ë¡œ ë³€ê²½í•˜ê¸°ê°€ í˜ë“­ë‹ˆë‹¤. í•˜ì§€ë§Œ ìŠ¤íŠ¸ë˜í‹°ì§€ íŒ¨í„´ì„ ì‚¬ìš©í•˜ë©´ êµ¬ì„±ì„ í†µí•´ í–‰ë™ì„ ì •ì˜í•˜ëŠ” ê°ì²´ë¥¼ ìœ ì—°í•˜ê²Œ ë°”ê¿€ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  - ìŠ¤í…Œì´íŠ¸ íŒ¨í„´ì€ ì»¨í…ìŠ¤íŠ¸ ê°ì²´ì— ìˆ˜ë§ì€ `ì¡°ê±´ë¬¸`ì„ ì§‘ì–´ë„£ëŠ” ëŒ€ì‹ ì— ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” íŒ¨í„´ì´ë¼ê³  ìƒê°í•˜ë©´ ë©ë‹ˆë‹¤. í–‰ë™ì„ ìƒíƒœ ê°ì²´ ë‚´ì˜ ìº¡ìŠí™”ì‹œí‚¤ë©´ ì»¨í…ìŠ¤íŠ¸ ë‚´ì˜ ìƒíƒœ ê°ì²´ë¥¼ ë°”ê¾¸ëŠ” ê²ƒë§Œìœ¼ë¡œë„ ì»¨í…ìŠ¤íŠ¸ ê°ì²´ì˜ í–‰ë™ì„ ë°”ê¿€ ìˆ˜ ìˆìœ¼ë‹ˆê¹Œìš”.

## ì½”ë“œ

```ts
// State : ìƒíƒœì— ë”°ë¥¸ ë™ì‘ì„ ì •ì˜í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ì…ë‹ˆë‹¤
interface State {
  onButton: (light: Light) => void;
  offButton: (light: Light) => void;
}

// ConcreteState : Stateì—ì„œ ì •ì˜ëœ ë©”ì†Œë“œë¥¼ êµ¬í˜„í•˜ëŠ” í´ë˜ìŠ¤ì…ë‹ˆë‹¤.
class ON implements State {
  private static on = new ON(); // ON í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¡œ ì´ˆê¸°í™”ë¨
  private constructor() {}

  public static getInstance() {
    // ì´ˆê¸°í™”ëœ ON í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°˜í™˜í•¨
    return this.on;
  }

  onButton(light: Light) {
    // ON ìƒíƒœì¼ ë•Œ On ë²„íŠ¼ì„ ëˆŒëŸ¬ë„ ë³€í™” ì—†ìŒ
    console.log('ë°˜ì‘ ì—†ìŒ');
  }

  offButton(light: Light) {
    light.setState(OFF.getInstance());
    console.log('Light Off!');
  }
}

class OFF implements State {
  private static off = new OFF(); // OFF í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¡œ ì´ˆê¸°í™”ë¨
  private constructor() {}

  public static getInstance() {
    // ì´ˆê¸°í™”ëœ OFF í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°˜í™˜í•¨
    return this.off;
  }

  onButton(light: Light) {
    // Off ìƒíƒœì¼ ë•Œ On ë²„íŠ¼ì„ ëˆŒëŸ¬ë„ On ìƒíƒœì„
    light.setState(ON.getInstance());
    console.log('Light On!');
  }

  offButton(light: Light) {
    // Off ìƒíƒœì¼ ë•Œ Off ë²„íŠ¼ì„ ëˆŒëŸ¬ë„ ë³€í™” ì—†ìŒ
    console.log('ë°˜ì‘ ì—†ìŒ');
  }
}

// Context
class Light {
  private state: State;

  constructor() {
    this.state = OFF.getInstance();
  }

  setState(state: State) {
    this.state = state;
  }

  onButton() {
    this.state.onButton(this);
  }

  offButton() {
    this.state.offButton(this);
  }
}

const light = new Light();
light.offButton();
light.onButton();
light.offButton();
```

---

## ì°¸ê³ 

- [ğŸ™ˆ\[ë””ìì¸íŒ¨í„´\] ìŠ¤í…Œì´íŠ¸ íŒ¨í„´ ( State Pattern )ğŸµ](https://victorydntmd.tistory.com/294)
- [ì½”ë”©ìŠ¤íƒ€íŠ¸](https://coding-start.tistory.com/247)
- [ì†Œë…„ì½”ë”©](https://boycoding.tistory.com/110)
- [Crocus](https://www.crocus.co.kr/1541)

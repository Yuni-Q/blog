---
title: CHAPTER6. 변경 가능한 데이터 구조를 가진 언어에서 불변성 유지하기
date: 2023-03-10 11:03:08
category: 쏙쏙 들어오는 함수형 코딩
tags: ['PART I 액션과 계산, 데이터']
draft: true
---

## 이번 장에서 살펴볼 내용

- 데이터가 바뀌지 않도록 하기 위해 카피-온-라이트를 적용합니다.
- 배열과 객체를 데이터에 쓸 수 있는 카피-온-라이트 동작을 만듭니다.
- 깊이 중첩된 데이터도 카피-온-라이트가 잘 동작하게 만듭니다.

#### 중첩된 데이터(rested data)

- 데이터 구조 안에 데이터 구조가 있는 경우 데이터가 `중첩`되었다고 말합니다.
- 배열 안에 객체가 있다면 중첩된 데이터입니다.
- 깊이 중첩(deeply nested)되었다는 말은 중첩이 이어진다는 말입니다. 깊다는 말은 상대적입니다.

## 카피-온-라이트 원칙 세 단계

- 복사본 만들기 / 본사본 변경하기 / 복사본 리턴하기
- 카피-온-라이트는 쓰기를 읽기로 바꿉니다.

## 불변 데이터 구조를 읽는 것은 계산입니다

- 변경 가능한 데이터를 읽는 것은 액션입니다.
- 쓰기는 데이터를 변경 가능한 구조로 만듭니다.
- 어떤 데이터에 쓰기가 없다면 데이터는 변경 불가능한 데이터입니다.
- 쓰기를 읽기로 바꾸면 코드에 계산이 많아집니다.

#### 용어 설명

- 중첩 데이터(nested data): 데이터 구조 안에 데이터 구조가 있는 것을 말하니다. 중첩 데이터에 대해 이야기할 때 안쪽(inner) 데이터와 최상위(top-level) 데이터라는 용어를 사용합니다.
- 얕은 복사(shallow copy): 중첩된 데이터에서 최상위 데이터 구조만 복사합니다.
- 구조적 공유(structural sharing): 두 개의 중첩된 데이터 구조가 어떤 참조를 공유한다면 구조적 공유라고 합니다. 데이터가 바뀌지 않는 불변 데이터 구조라면 구조적 공유는 안전합니다. 구조적 공유는 메모리를 적게 사용하고, 모든 것을 복사하는 것보다 빠릅니다.

## 요점 정리

- 함수형 프로그래밍에서 불변 데이터가 필요합니다. 계산에서는 변경 가능한 데이터에 쓰기를 할 수 없습니다.
- 카피-온-라이트는 데이터를 불변형으로 유지할 수 있는 원칙입니다. 복사본을 마들고 원본 대신 변경하는 것을 말합니다.
- 카피-온-라이트는 값을 변경하기 전에 얕은 복사를 합니다. 그리고 리턴합니다. 이렇게 하면 통제 할 수 있는 범위에서 불변성을 구현할 수 있습니다.
- 보일러 플레이트 코드를 줄이기 위해 기본적인 배열과 객체 동작에 대한 카피-온-라이트 버전을 만들ㅇ러 두는 것이 좋습니다.

---

## 참고

- [쏙쏙 들어오는 함수형 코딩](https://product.kyobobook.co.kr/detail/S000001952246)

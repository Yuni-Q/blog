---
title: 병행처리
date: 2020-07-01 09:07:71
category: 코딩을 지탱하는 기술
draft: false
---

- 한 CPU에서 여러 개를 동시에 처리하는 방법은 사람이 눈치 챌 수 없는 만큼의 시간만큼의 짧은 시간에 복수의 처리를 변경해가며 실행합니다.

## 방법

1. 협력적 멀티 테스크

- 타이밍이 좋은 시점에 교대합니다.
- 자발적인 처리 교대하는 방법입니다.

2. 선점적 멀티 테스크

- 일정 시간에 교대합니다.
- 강제적으로 중단 시켜 다른 프로그램 시작합니다.

## 경합 상태(Race Condition)

- 이 상태를 Thread safe가 아니다 라고도 하며 발생경우는 아래와 같습니다.

1. 2가지 처리가 변수를 공유하고 있습니다.
2. 적어도 하나의 처리가 그 변수를 변경합니다.
3. 한쪽 처리가 한 단락 마무리 되기 전에, 다른 한쪽의 처리가 끼어들 가능성있습니다.

### 1번 해결방안

#### 프로세스

- UNIX에서는 실행중인 프로그램을 이야기합니다.
- 메모리를 공유하지 않습니다.
- 메모리 영역을 지정해서 사용합니다.

#### 스레드

- 메모리를 공유하는 경량 프로세스입니다.
- UNIX 출시 10년 후 메모리를 공유하는 기능이 필요하여 만들어졌습니다.

#### 액터

- 메모리를 공유하지 않습니다.
- 메세지를 보내 데이터를 공유합니다.

### 2번 해결방안

#### Immutable, const

- 메모리를 공유해도 변경을 하지 않으면 문제가 없습니다.
- getter는 있으나, setter가 없습니다.

### 3번 해결방안

#### 코루틴

- 끼어들지 않게 협력적 스레드를 만듭니다.

#### 락

- 지금 끼어들면 곤란해 라는 표식으로 사용중이라는 표식입니다.
- \[문제점] 2개의 명령이 a,b의 unlock과 lock을 교차 요청하면 무한이 상대방 락이 풀리는 것을 기대하는 Deadlock(교착상태)가 발생합니다.
  - \[해결방안] 트렌젝션 메모리 접근법을 착용합니다.
  - 트렌젝션 메모리는 실험적으로 해보고, 실패하면 처음부터 다시 고쳐서하고 성공하면 변경을 공유하는 기법입니다.

## 참고

- [코딩을 지탱하는 기술](https://peter-cho.gitbook.io/book/11/undefined-5#race-condition)

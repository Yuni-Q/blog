---
title: 야후 쇼핑 프런트 엔드를 지원하는 공통 배포 기술
date: 2023-02-12 17:02:22
category: develop
tags: []
draft: true
---

https://www.youtube.com/watch?v=7ATMvUGhni4

## 공통 UI 배포 서비스 탄생까지의 경위

- 애플리케이션이 다르면 공통 UI도 따로 구현된다.

### 공통 UI 수정하는 경우

- 담당자들을 찾는 것도 어렵고 찾아도 일정을 잡는 것도 어렵다.
- 미팅을 해도 각자의 일 때문에 일정을 맞추기 어렵다.
- 애플리케이션을 놓치거나 결과물이 다를 수 있다.

## 공통 UI 서비스

- ptah-commons
  - UI는 아니지만 UI 구축과 긴밀한 것들(유저 정보 취득, 가공, 로그인 판정 로직)
- ptah-v2
  - UI 배포 시스템(헤더, 푸터)
- module-service
  - 후발 서비스(홈, 검색)에서 회유 모듈

### ptah-v2

- 공수의 삭감
  - 한곳에 만듦으로 인해서 해소
- 레이아웃 스펙 통일
  - 한곳에 만듦으로 인해서 해소
- 프론트 작업 제로로 변경
  - 마이크로 프론트엔드를 통해 해소
- 프론트 언어, 프레임워크 제한하지 않음
  - 마이크로 프론트엔드를 통해 해소
- 리액트 사용
  - 마이크로 프론트엔드를 통해 해소
- UX를 훼손하지 않는다.
  - 다른 관점에서 접근이 필요해서 보류

### 마이크로 프론트엔드

- 복수 프로덕트에서 하나의 페이지를 구성하여 각각 원하는 프레임워크를 사용한다.

#### 장점

- 단계적으로 변경 가능
- 심플하고 낮은 결합도
- 별도의 배포

## 공통 UI 배포 서비스 지원하는 기술

### 마이크로 프론트엔드

- SPA에 대한 기사들이 대부분이다. 쇼핑은 SPA가 아니다.
- link tag과 script tag, 커스텀 엘리먼트 태그를 사용한다.
- 커스텀 엘리먼트로는 ui를 구현하지는 않는다. React로 구현
- 마이크로 프론트엔드의 구현! 브라우저 상(런타임)에서 UI를ㅌ 구축
- 마이크로 프론트엔드를 위한 Framework-free 같은 것들을 사용하지 않음.

### Layout shift

- SSR을 사용한다.
- Isomorphic: SSR + CSR
- SSR로 구현된 것은 동적인 HTML이라서 이벤트 헨들러 같은 것들이 없어져서 CSR을 다시해야한다.
  - SSR, CSR 구조가 다를 수 있기 때문에 하이드레이트가 아니라 createElement를 한다.

### 효과

- 개발비용 절감
  - cost 1/8, 20 man-months 감소
- 커뮤니케이션 감소
- 리드 타임 감소
- 배포 건 수 감소

## 정리

- 비 SPA에서의 마이크로 프론트엔드

## QnA

- 의존 관계를 없애기 위해 노력하면서 개발했다.
- SSR을 하면 통신 비용이 들지만 레이아웃 시프트가 더 큰 영향이라서 방지하기 위해 사용했다.
- CSS의 의존도를 어떻게 풀어낼지는 디자인시스템 디자이너와 논의 중
- 효과측정(KPI)은 실제 개별로 만들었을 때와 비교
- Next를 사용하지 않은 이유는 기술스택이 다양하기 때문이다.
- 버전을 선정하지 않는데 버전을 사용해서 사용 가능할 수 없다.
- 남북을 통일시킨 신의 이름이 ptah이다(이집트 신)

## 느낀점

- 공통 UI가 디자인시스템일 거라고 생각했는데 조금 다른 부분에서 제공하고 있다. 해당 부분은 모듈 페더레이션과 관련한 것처럼 우리 회사에서도 별도의 버저닝 없이 배포하려는 것과 같아 보인다.
- 마이크로프론트엔드가 여러 개념이 있는거 같은데 해당 발표에서 말해주는 것이 가장 대표적인거 같다. 조금 더 궁금한 것이라면 각각의 영역이 어떻게 통신하는지가 궁금하다. 완전 별개의 애플리케이션처럼 상호작용이 없을때만 가능한 것일가?

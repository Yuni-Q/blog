---
title: 코어 웹 바이탈의 빠른 URL 수를 99% 이상으로 유지하기
date: 2023-02-12 17:02:26
category: develop
tags: []
draft: true
---

[링크](https://www.youtube.com/watch?v=-f-5f5-IBdg)

## 소개

- SEO는 중요하다.
  - 검색이 줄면 유저가 줄고 수익이 줄어든다.
- UX는 중요하다.
  - UX가 좋지 않으면 사용자가 줄어든다.

## 코어 웹 바이탈이란 무엇인가

- 웹 페이지를 로딩했을 때 3가지 지표
  - LCP, CLS, FID

### LCP(Largest Contentful Paint)

- 최대 콘텐츠가 표시될때 까지 시간.
- 2.5초 내로 로딩되어야 한다.

### CLS(Cumulative Layout shift)

- 누적 레이아웃 이동
- 유저가 의도한 이동이 0.5초 이내라면 문제가 없다.

### FID(First Input Delay)

- 유저가 조작을 시작했을때와 브라우저의 반응 속도
- 100ms 이내여야 한다.

## 어떻게 개선 했는가

### LCP

- 최대 콘텐츠를 얼마나 빠르게 로딩하는가?
- 최대 콘텐츠가 무엇인가?
- 라이트하우스로 파악한다.
- HTML 로딩 중 js를 만나면 블록 되기 때문에 async와 defer를 사용한다. 또한 최대 컨텐츠보다 하단에 위치한다.
- preload로 다른 이미지보다 빠르게 로딩하게 한다.
- 이미지 포맷을 webp로 합니다.
- API를 병렬처리 한다.
- 인터섹션옵저버를 통해 병렬 로딩한다.
- 응답을 레디스로 캐시한다.
- 데이터베이스에 인덱스를 붙인다. 디비에서 sum과 average 등을 사용하지 않는다. 일괄적으로 배치에서 가공한다.

### CLS

- 요소가 움직이지 않도록 한다.
  - 이미지, 지연 취득한 데이터, 광고
- 이미지의 너비와 높이를 지정한다.
- 높이가 너비에 따라 달라질 경우 높이를 확보하기 위한 레퍼를 준비한다.
  - 또는 aspect-ratio를 활용한다.
- 지연 취득 정보의 스켈레톤을 준비한다.
- 광고의 min-height를 지정한다.

### FID

- js file size가 큰 경우 발생
- 웹팩 번들 analyzer를 통해 분석해서 대응한다.
- moment 대신 dayjs 사용
- lodash는 함수별 import를 사용한다.
- char.js는 인터섹션 옵저버를 통해 다이나믹 import를 한다.
- 웹팩이 없다면 라이트하우스 진단 결과를 참고한다.
- 미사용된 js 제거
- tag manager를 필요한 페이지만 적용
- 외부 툴에서 불필요한 기능을 사용하지 않는다.

## 고품질 유지하기

- 현재 상황 파악
  - 구글 서치 콘솔
- 실제 유저의 데이터이다. 실제 UX에 영향을 미친다.
- Lighthouse CI를 통해 대응한다.
- 인적 자원 문제, 시간 문제는 대응 방침을 명확하고 간결하게 한다.

## 정리

- 코어 웹 바이탈은 SEO와 UX에 영향을 준다.
- 구글 서치 콘솔을 사용한다.
- LCP와 CLS는 비교적 간다한기 때문에 시도해보자
- 구현 방침을 정리해 두면 좋다.
- Lighthouse 사용하면 좋다.

## QnA

- Lighthouse 통해서 정기적으로 확인하고 있기 때문에 이후에 배포 한다.
- Lighthouse 개선은 확인된다.
- 실제로 효과를 보지 못한 것도 많다.
- 다이나믹 임프트 차트가 최상위에 나온다면 어떻게 되는가?
  - 해당 경우가 많지 않다.
  - 차트 위치에 관련해서 타부서와도 커뮤니케이션에 문제가 없었다.
- 광고가 많지 않아서 의식하지 않았다.
  - 광고는 사이즈가 크기 때문에 이미지를 줄이는 것을 생각해 볼 수 있겠다.
- 가이드가 명확하기에 불협화음이 생기지 않았다.
- 혼재 페이지가 있어도 탑 페이지만 분석한다.
- 대량의 데이터를 로딩하는 경우 동영상을 대응하지 않기 때문에 답변하기 어렵다.
  - UI 팀과의 대응이 필요해 보인다.
- 스켈레톤은 부분적으로 사용하고 있다.
  - LCP가 스켈레톤 뒤로 가면 해롭다. 높이를 제약하는 것이 더 좋다. LCP는 스켈레톤이 들어가지 않는다.

## 느낀점

- LCP, CLS, FID 이야기가 여러 발표에 걸쳐서 많이 나오는거 같다. 한국은 인터넷 속도가 빨라서 그렇지 않지만 외국에서는 더욱 더 중요한거 같다.
- 대응 방침을 규격화 하고 가이드 하는 것이 매우 좋아 보인다.
- 다양한 툴(서치 콘솔, 라이트하우스)들도 잘 활용해야 겠다.

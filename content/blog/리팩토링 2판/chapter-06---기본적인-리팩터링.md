---
title: CHAPTER 06 - 기본적인 리팩터링
date: 2021-08-02 01:08:18
category: 리팩토링 2판
tags: []
draft: true
---

## 함수 추출하기(Extract Function)

- 반대 리팩터링 함수 인라인하기

```js
// as-is
function printOwing(invoice) {
  printBanner();
  let outstanding = calculateOutstanding();
  //세부 사항 출력
  console.log(`고객명: ${invoice.customer}`);
  console.log(`채무액: ${outstanding}`);
}
```

```js
// to-be
function printOwing(invoice) {
  printBanner();
  let outstanding = ca1cu1ateOutstanding();
  printDetails(outstanding);
  function printDetails(outstanding) {
    console.log(` 고객 명 ${invoice.customer}`);
    console.log(`채무액: ${outstanding}`);
  }
}
```

- 코드 조각을 찾아 무슨 일을 하는지 파악한 다음, 독립된 함수로 추출하고 목적에 맞는 이름을 붙입니다.
- `목적과 구현을 분리`하는 방식이 가장 합리적인 기준으로 보입니다. 코드를 보고 무슨 일을 하는지 파악하는 데 한참이 걸린다면 그 부분을 함수로 추출한 뒤 `무슨 일`에 걸맞는 이름을 짓습니다.
- 함수를 짧게 만들면 함수 호출이 많아져서 성능이 느려질까 걱정할 수 있지만 함수가 짧으면 캐싱하기가 더 쉽기 때문에 컴파일러가 최적화하는 데 유리할 때가 많습니다. 성능 최적화에 대해서는 항상 일반적인 지침을 따르도록 합니다(첫 번째, 하지마라. 두 번째(전무가 한정) 아직 하지마라.).
- 짧은 함수의 이점은 이름을 잘 지어야만 발휘되므로 이름 짓기에 특별히 신경 써야 합니다.

### 절차

1. 함수를 새로 만들고 목적을 잘 드러내는 이름을 붙입니다(`어떻게`가 아닌 `무엇을` 하는지가 드러나야 합니다.).
2. 추출할 코드를 원본 함수에서 복사하여 새 함수에 붙여넣습니다.
3. 추출한 코드 중 원본 함수의 지역 변수를 참조하거나 추출한 함수의 유효범위를 벗어나는 변수는 없는지 검사합니다. 있다면 매개변수로 전달합니다.
4. 변수를 다 처리했다면 컴파일합니다.
5. 원본 함수에서 추출한 코드 부분을 새로 만든 함수를 호출하는 문장으로 바꿉니다(즉, 추출한 함수로 일을 위임합니다).
6. 테스트합니다.
7. 다른 코드에 방금 추출한 것과 똑같거나 비슷한 코드가 없는지 살핍니다. 있다면 방금 추출한 새 함수를 호출하도록 바꿀지 검토합니다(일라인 코드를 함수 호출로 바꾸기).

### 예시: 유효범위를 벗어나는 변수가 없을 때

### 예시: 지역 변수를 사용할 때

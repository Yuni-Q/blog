---
title: 3장 긴 코드 조각내기
date: 2023-07-26 22:07:61
category: five lines of code
tags: []
draft: true
---

## 이번 장에서 다룰 내용

- 다섯 줄 제안(FIVE LINES)으로 지나치게 긴 메서드 식별하기
- 세부 사항을 보지 않고 코드 작업하기
- 메서드 추출(EXTRACT METHOD)로 긴 메서드 분해하기
- 호출 또는 전달, 한 가지만 할 것(EITHER CALL OR PASS)으로 추상화 수준 맞추기
- if 문은 함수의 시작에만 배치로 if 문 분해하기

## DRY와 KISS의 지침을 따른 경우데도 혼한스로운 코드

- 메서드가 여러 가지 다른 일을 수행한다.
- 낮은 수준의 원시 연산(배열 조작, 산술 연산 등)을 사용한다.
- 주석과 적절한 메서드와 변수명 같이 사람이 읽을 수 있는 텍스트가 부족하다.

## 3.1 첫 번째 규칙; 왜 다섯 줄인가?

### 3.1.1 규칙: 다섯 줄 제한

- 메서드는 {와 }를 제외하고 5줄 이상이 되어서는 안 됩니다.
- 문장이라고 하는 코드 한 줄은 하나의 if, for, while 또는 세미콜론으로 끝나는 모든 것을 말합니다.
  - 할당, 메서드 호출, return 같은 것입니다.
  - 공백과 중괄호는 제외합니다.
- 특정 수치로 줄 수를 제한하는 것보다 제한이 있다는 것 자체가 중요합니다.

#### 스멜

- 메서드가 길다는 것 자체가 스멜입니다. 메서드는 한 가지 작업만 해야 합니다.

#### 의도

- 하나의 메서드 보다 분리된 메서드가 이해하기 쉽습니다.
  - 분리된 각 메서드는 이름으로 코드의 의도를 전달합니다. 주석과도 같은 효과를 보입니다.
  - 작은 메서드에 적절하게 이름을 붙이면 큰 함수의 이름을 정하는 데도 도움이 됩니다.

## 3.2 함수 분해를 위한 리팩터링 패턴 소개

- 코드를 이해하기 위한 첫 번째 단계는 항상 함수명을 고려하는 것입니다.

### 3.2.1 리팩터링 패턴: 메서드 추출

- 메서드 추출은 한 메서드의 일부를 취해서 자체 메서드로 만듭니다.
- if의 일부 분기만 return 문을 가지고 있을 경우 메서드를 추출하는 데 방해가 될 수 있으므로 메서드의 끝에서 시작해 위로 작업해 가는 것이 좋습니다. 이는 return 문을 가진 조건을 메서드의 앞쪽에 배치하게 해서 결과적으로 모든 분기에서 return할 수 있게 됩니다.

#### 절차

1. 추출할 줄의 주변을 빈 줄로 표시하는데, 주석으로 표시할 수도 있습니다.
2. 우너하는 이름으로 새로운 빈 메서드를 만듭니다.
3. 그룹의 맨 위에서 새로운 메서드를 호출합니다.
4. 그룹의 모든 줄을 선택해서 잘라내어 새로운 메서드의 본문에 붙여 넣습니다.
5. 컴파일합니다.
6. 매개변수를 도입하여 호출하는 쪽의 오류를 발생시킵니다.
7. 이러한 매개변수 중 하나를 반환 값으로 할당해야 하는 경우
8. 새로운 매개변수의 마지막에 return x을 추가합니다.
9. 새로운 메서더르르 호출하는 쪽에서 x = newMethod(...)와 같이 반환 값을 할당합니다.
10. 컴파일합니다.
11. 호출 시 인자를 전달해서 오류를 잡습ㄴ디ㅏ.
12. 사용하지 않는 빈 줄과 주석을 제거합니다.

#### 교훈

- 번거롭기는 하지만 `안전하다`는 것입니다.
  - 고급스럽워 보이려고 노력하다가 어려움을 겪을 수 있는데, 보통은 그럴 만한 가치가 없습니다.
- 이 절차는 아무것도 손상시키지 않습니다.

#### 추가 자료

1. 공통 하위 표현식 추출(Extract common sub-expression)
2. 메서드 추출
3. 지역변수의 인라인화

## 3.3 추상화 수준을 맞추기 위해 함수 분해

### 3.3.1 규칙: 호출 또는 전달, 한 가지만 할 것

- 함수 내에서는 객체에 있는 메서드를 호출하거나 객체를 인자로 전달할 수 있지만 둘을 섞어 사용해서는 안 됩니다.
- 함수의 내용은 동일한 추상화 수준에 있어야 합니다.
  - 직접 조작하는 낮은 수준의 작업과 다른 함수에 인자로 전달하는 높은 수준의 호출이 공존해서는 메서드 이름 사이의 불일치로 가독성이 떨어질 수 있습니다.

## 3.4 좋은 함수 이름의 속성

- 함수명을 지을 때는 항상 나중에 함수가 더 작아졌을 때 일므을 개선할 수 있는지를 평가해 봐야 합니다.

#### 좋은 이름의 속성

- 정직해야 합니다. 함수의 의도를 설명해야 합니다.
- 완전해야 합니다. 함수가 하는 모든 것을 담아야 합니다.
- 도메인에서 일하는 사람이 이해할 수 있어야 합니다. 작업 중인 도메인에서 사용하는 단어를 사용하십시오. 그렇게 하면 의사소통이 더욱 효율적이게 되고 팀원 및 고객과 코드에 대해 더 쉽게 이야기 할 수 있다는 장점이 있습니다.

## 3.5 너무 많은 일을 하는 함수 분리하기

### 3.5.1 규칙: if 문은 함수의 시작에만 배치

- 무언가를 확인하는 일은 한 가지 일입니다.
- if 문이 하나의 작업이기 때문에 일르 분리할 때 이어지는 else if는 if 문과 분리할 수 없는 원자 단위로 봅니다. 이것은 if 문이 else if와 함께 문맥을 형성할 때 메서드 추출로 수행할 수 있는 가장 작은 단위가 if 문과 이어지는 else if까지 포함한다는 것을 의미합니다.

## 요약

- `다섯 줄 제한` 규칙은 메서드는 다섯 줄 이하여야 한다는 말입니다. 이것은 두 가지 이상의 작업을 수행하는 메서드를 식별하는 데 도움이 됩니다. 리팩터링 패턴인 `메서드 추출`을 사용해서 긴 메서드를 분해하고 메서드 이름으로 주석을 대신합니다.
- `호출 또는 전달, 한 가지만 할 것` 규칙은 하나의 메서드 내에서 객체에 있는 메서드를 호출하거나 객체를 매개변수로 전달할 수 있지만, 둘 다 해서는 안 된다는 말입니다. 여러 수준의 추상화가 섞여 있는 메서드를 식별하는 데 도움이 됩니다. 이 또한 `메서드 추출`을 사용해 서로 다른 수준의 추상화를 분리합니다.
- 메서드 이름은 투명하고 완전해야 하며 이해할 수 있어야 합니다. `메서드 추출`을 사용하면 가독성이 향상되도록 매개변수의 이름을 바꿀 수 있습니다.
- `if 문은 함수의 시작에서만 배치` 규칙은 if를 사용해 조건을 확인하는 경우 한 가지 작업만 수행하므로 메서드가 다른 작업을 수행하지 못하게 합니다. 이 규칙은 또한 하나 이상의 작업을 수행하는 메서드를 식별하는데 도움이 됩니다. if 문을 분리하기 위해 `메서드 추출`을 사용합니다.

---

- [파이브 라인스 오브 코드](https://product.kyobobook.co.kr/detail/S000200661796)

---
title: 메모리
date: 2020-04-16 12:04:53
category: develop
draft: true
---

- 단편화란 메모리 상에서 적재되고, 해제되는 과정에서 발생하는 메모리 사이의 사용하지 못할 정도로 작은 빈 공간 입니다.
- 크게 외부 단편화와 내부 단편화로 나뉩니다.
- 외부 단편화는 프로세스와 프로세스 사이에 발생하는 빈 공간입니다.
  - 외부 단편화는 메모리를 다시 재정렬하는 압축을 통해 해결할 수 있지만, 효율이 좋지 않습니다.
- 내부 단편화는 프로세스 안에서 발생하는 빈 공간입니다.

## First Fit

- 메모리를 할당할 때, 가장 먼저 발견한 곳에 집어 넣습니다.

## Best Fit

- 메모리를 할당할 때, 사용 가능한 공간 중 가장 작은 곳에 집어넣습니다.(정렬 필요합니다.)

## Worst Fit

- 메모리를 할당할 때, 사용 가능한 공간 중 가장 큰 곳에 집어넣습니다.(정렬 필요합니다.)

## 공간 효율성

- Best Fit > First Fit > Worst Fit

## 시간 효율성

- First Fit > Best Fit = Worst Fit

## 가상 메모리

- 가상 메모리는 기존의 물리 메모리를 물리 메모리와 논리 메모리로 나눔으로써 더욱 효과적으로 쓰기 위한 개념 입니다.
- 논리 메모리 테이블은 물리 메모리와 보조기억장치 메모리와 매핑되어 있으며, 프로세스는 가상메모리를 물리 메모리처럼 인식하고 사용하게 됩니다.
  - 가상 메모리는 보조기억장치를 주기억장치처럼 쓰게 하는 것으로 착각하고 있는 경우가 있습니다.

## 페이징

- 외부 단편화의 압축 작업을 해소하기 위한 방법론으로, 물리 메모리는 Frame, 논리 메모리는 Page라는 고정 크기의 블록으로 나눕니다.
- 프로세스를 페이지 단위로 나눈 뒤에, 사용하지 않는 영역을 보조기억장치에 적재합니다. 이를 `페이징 되었다`고 하는데, 만약 이 페이징 된 영역에 접근해야 하면 페이징 폴트를 발생시킨 후 메모리에 적재시킵니다(요구 페이징).
- 페이징된 정보는 페이징테이블에 저장됩니다.
- 단점으로는 내부 단편화가 발생할 수 있습니다.
- 가상메모리의 요구 페이징 과정에서 만일 물리 메모리가 모두 사용중일 경우, 페이징 교체가 이루어져야 한다.

### 교체 흐름

- 디스크에서 필요한 페이지의 위치를 찾습니다.
- 페이지 교체 알고리즘을 통해 희생될 페이지를 찾습니다.
- 찾은 페이지를 비운 후 새 프레임을 덮어쓰고, 테이블을 수정합니다.
- 프로세스를 재시작합니다.

### 페이지 교체 알고리즘 종류

#### FIFO (First In First Out)

- 말 그대로 먼저 들어온 페이지를 먼저 내보냅니다.
- 간단한 알고리즘이지만, 페이지의 중요도를 따지지 않기 때문에 초기 변수가 담긴 페이지를 내려버리는 등 여러 문제를 초래할 수 있습니다.

#### 최적 페이지 교체 (Optimal Page Replacement)

- 앞으로 가장 사용되지 않을 페이지를 계산하여 교체합니다.
- 다만 모든 프로세스의 계획을 파악하기가 쉽지 않기 때문에, 어떤 페이지를 교체해야 하는가의 알고리즘을 구현할 때 어려움이 있습니다.

#### LRU (Last Recently Used)

- 가장 나중에 사용된 페이지를 교체합니다.
- FIFO보단 좋고 OPT보단 못합니다.

#### LFU (Least Frequently Used)

- 가장 덜 사용된 페이지를 교체합니다.
- 활발한 페이지는 사용이 많이 되었을거라는 가정하에 만든 알고리즘 입니다.
- 초기에 많이 사용되었다가 지금은 사용되지 않는 페이지의 경우 교체가 이루어지지 않는다는 문제가 있습니다.

#### MFU (Most Frequently Used)

- 가장 많이 사용된 페이지를 교체합니다.
- 가장 적게 사용된 페이지가 최근에 올라오고 계속 사용될 것이라는 가정합니다.
- 잘 쓰이지 않습니다.

## 세그멘테이션

- 메모리를 페이지와는 다르게 가변 크기의 세그멘테이션으로 나눕니다(물리 메모리 블럭 크기와 다르다).
- 나누는 시점은 메모리를 사용하게 되는 시점입니다.
- 각 세그멘테이션은 스택, 데이터, 힙, 코드 영역 등으로 나뉘게 됩니다. 나뉜 세그멘테이션은 시작 주소값과 길이 값이 세그멘테이션 테이블에 저장됩니다.
- 자주 사용하면 외부 단편화가 발생할 수 있습니다.

## 보통 페이징과 세그멘테이션 둘 다 사용한다고 합니다.

## 참고

- [기술면접 준비하기](https://velog.io/@hygoogi/%EA%B8%B0%EC%88%A0%EB%A9%B4%EC%A0%91-%EC%A4%80%EB%B9%84%ED%95%98%EA%B8%B0)

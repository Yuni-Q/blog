---
title: 12장 대규모 시스템의 설계와 개선
date: 2023-02-19 00:02:25
category: 프로그래머의 뇌
tags: []
draft: true
---

## 이 장에서는 다음과 같은 내용을 다룬다

- 설계에 대한 여러 가지 결정이 코드베이스의 이해도에 미치는 영향
- 설계에 대한 여러 가지 결정 사이의 트레이드오프
- 더 나은 인지 처리를 위한 기존 코드베이스 설계의 개선

## 서론

- 코드베이스 인지 차원(cognitive dimensions of codebase, CDCB)이라는 수정된 프레임워크를 사용하여 기존 코드베이스의 설계를 개선하는 방법에 대해 자세히 다룰 것이다.

## 12.1 코드베이스의 특성 조사

- 일을 더 쉽게 할 수 있게 해준 것은 무엇인가?
  - 설명서의 존재, 좋은 변수 이름, 주석문
- 일을 더 어렵게 만든 것은 무엇인가?
  - 복잡한 코드 또는 문서의 부족

### 12.1.1 인지적 차원

- 인지적 차원 표기법(cognitive dimensions of notation, CDN)은 기존 대형 코드베이스의 사용성을 평가하는 데도 사용할 수 있다.
- CDCB는 CDN의 일반화된 버전이다. 이것을 통해 코드베이스를 검토하고, 코드베이스를 어떻게 이해하고 개선할 수 있을지 살펴본다. CDCB는 다른 프로그래머들이 수정하지는 않고 사용만 하는 라이브러리와 프레임워크의 코드에 특히 유용하다.

#### 오류 경향성(error proneness)

- 논의할 첫 번째 차원은 오류 경향성이라고 불린다.
- 일부 프로그램이 언어에서는 다른 언어보다 실수를 저지르기 쉽다.
- 프로그래밍 언어가 아닌 코드베이스 역시 오류 경향성이 있는데, 예를 들어 일관성 없는 규칙, 문서 부족, 모호한 이름 때문이다.
- 타입 시스템이 오류를 방지한다.
  - 컴파일러가 오류를 지적하는 코드의 위치는 런타임에 오류가 발생하는 위치와 동일했다.

#### 일관성(consistency)

- 비슷한 것들은 서로 얼마나 유사한가? 이름은 항상 동일한 방식으로 만들어졌는가? 동일한 이름 틀을 사용하여 만들어지는가? 코드 파일의 레이아웃이 다른 클래스와 유사한가?
- 많은 프로그래밍 언어에서 일관성이 있는지 알 수 있는 한 가지 예로 함수 정의가 있다. 내장 함수는 일반저긍로 사용자 저의 함수와 동일한 사용자 인터페이스를 가지고 있다.
- 이름과 규약을 일관성 없이 사용하는 프레임워크나 언어는 인지 부하를 더 많이 가져올 수 있다.
- 일관성은 오류 경향성과 관련이 있다. 언어적 안티패턴을 갖는 코드는 오류가 발생하기 쉽고 인지 부하가 커진다.
  - 언어적 안티패턴의 예: 코드 구현과 이름이 일치하지 않음

#### 분산성(diffuseness)

- 너무 많은 라인으로 작성돼 있어 이해하기 어려운 긴 메서드는 잘 알려진 코드 스멜 중 하나다.
- 분산성은 코드의 줄 수뿐만 아니라 코드가 얼마나 많은 청크로 구성되어 있는지도 고려할 수 있다.
- 같은 프로그래밍 언어를 사용해서 동일한 일을 하지만 분산성이 다른 코드를 작성할 수도 있다.

#### 숨겨진 의존성(hidden dependency)

- 숨겨진 의존성 차원은 의존 항목이 사용자에게 어느 정도로 가시적으로 나타나는지 보여준다.
- 어떤 파일이 코드 파일과 분리해야 한다는 요구 사항이 있다면 이것 역시 숨겨진 의존성의 또 다른 예다.
- 다른 함수나 클래스 안에서 어떤 함수가 호출되는지 아는 것과 그 반대의 경우, 즉 주어진 함수를 어떤 클래스나 함수가 호출하는지 아는 것 중에서 전자가 후자보다 더 쉽다.
- 최근의 IDE는 숨겨진 의존성을 보여주는 기능을 가지고 있지만, 의존 항목을 찾기 위해서는 여전히 마우스 클릭이나 단축키를 사용하는 추가적인 동작이 필요하다.
- 코드 작성자는 보다 광범위한 문서로 숨겨진 의존성을 보완할 수 있다.

#### 잠정성(provisionality)

- 잠정성 차원은 도구를 사용하는 동안 생각하는 것이 얼마나 쉬운지에 대한 것이다.
  - 자신이 무엇을 만들고 있는지 확신하지 못하면 탐구적인 방식으로 프로그래밍을 하게 된다.
- 탐구할 때는 펜과 종이 또는 화이트보드를 사용할 수 있다. 이러한 도구는 자유롭게 스케치하고, 모든 종류의 주석을 기록하고, 불완전하거나 잘못된 코드를 문제없이 작성할 수 있기 때문에 `궁극적인 잠정성`을 제공한다.
- 코드베이스나 프로그래밍 언어가 매우 엄격하다면 코드를 사용해 생각을 표현하는 것은 어려울 수 있다. 이런 경우는 `잠정성이 낮다`고 말한다.
- 코드에 대한 계획을 생각하는 동시에 타입과 문법에 대해서도 생각하는 것은 초보자에게 너무 많은 인지 부담을 줄 수 있다.

#### 점도(viscosity)

- 점도는 특정 시스템을 변경하는 것이 얼마나 어려운가에 대한 차원으로, 잠정성과 관련이 있다.
- 일반적으로 동적 타입 언어로 작성된 코드를 변경하는 것이 조금 더 쉽다.
- 코드를 변경하고 나서 컴파일하거나 테스트 실행에 시간이 오래 걸린다면, 그 변경에 대한 점도는 증가한다.

#### 점진적 평가(progressive evaluation)

- 점진적 평가 역시 잠정성과 관련 있다. 이 차원은 주어진 시스템에서 부분적인 작업을 확인하거나 실행하는 것이 얼마나 쉬운지에 대한 것이다.
- 잠정성이 높은 시스템은 사용자가 불완전한 아이디어를 스케치할 수 있는 것이 가능하다. 점진적 평가를 통해 사용자는 완성되지 않은 코드나 불완전한 코드를 실행할 수 있다.
- 함수에 선택적 매개변수가 있는 경우, 라이브러리 사용자는 먼저 기본값으로 코드를 컴파일하고 실행하여 시스템이 모든 단계에서 작동하는 것을 확인한 다음, 매개변수를 하나씩 단계적으로 갱신할 수 있다.
- 점진적 평가 차원이 낮은 시스템에서는 완료되거나 완벽하지 않은 코드를 실행할 수 없으므로 잠정성을 억제한다.

#### 역할 표현력(role expressiveness)

- 역할 표현력의 차원은 프로그램에서 여러 가지 다른 부분의 역할을 얼마나 쉽게 알 수 있는지를 나타낸다.
- 역할 표현력의 간단한 예는 'file.open()'처럼 거의 모든 프로그램ㅇ 언어에서 매개변수가 없는 함수를 호출할 때 여전히 끝에 두 개의 괄호를 가지고 있다는 점이다.
- 역할 표현력의 또 다른 유명한 예는 구문 강조(syntax highlighting)다.
- 문법을 통해서도 역할 표현력이 나타날 수 있다.
  - 불리언 값을 반환하는 함수로 set이 아니라 is_set을 초출하면 이 코드를 읽을 때 변수의 역할을 이해하는 데 도움이 된다.
- 언어적 안티패턴은 코드베이스가 역할 표현력이 낮고 이해하기 어렵다.

#### 매핑 근접성(closeness of mapping)

- 매핑 근접성 차원은 프로그래밍 언어 또는 코드가 문제의 해결 영역에 얼마나 가까운지를 의미한다.
- 훌륭한 매핑 근접성을 갖는 프로그래밍 언어는 엑셀이다.
- 범용적인 프로그래밍 언어는 매핑 근접성이 좋지 않다.
- 코드베이스도 비즈니스 영역과의 매핑 근접성이 좋을 수 있다. 대상 도메인의 개념과 단어를 사용하는 코드베이스는 일반적인 용어를 사용하는 코드베이스보다 대체로 이해하기 쉽다.
- 도메인 코드에 더 잘 통합하는 것에 대한 관심이 증가하고 있다. 도메인 주도 설계(domain-driven design) 척할은 코드의 구조와 식별자가 비즈니스 도메인과 일치해야 한다고 규정한다. 이것은 코드베이스에서 매핑 근접성을 높이는 방향으로의 움직임이다.
- 변수명은 도메인 언어로 표기되어 있는가? 이름이 코드 밖의 어떤 프로세스를 지칭하는지 명확히 알 수 있는가? 이름이 코드 밖의 어떤 객체를 가리키는지 명확히 할 수 있는가?

#### 힘든 정신 활동(hard mental operation)

- 어떤 시스템에서는 사용자가 시스템 외부에서 힘든 정신 활동을 수행할 때 생각하는 것이 매우 어려울 수 있다.
- 생각하게 하는 것이 성과를 거둘 수도 있다.
  - 엄격한 타입 시스템에서는 오류 수가 적다든지 포인터를 사용하면 성능이 더 우수하거나 메모리 사용이 더 효율적이다.
- 코드베이스 내에서 사람들이 수행할 수 있는 힘든 정신 활동의 예로는 종종 사용자가 기억해야 할 것이 많은 상황이다.
- 모호한 함수 이름은 매핑 근접성을 낮추고 이런 이름들은 힘든 정신 활동을 초래한다. 비정보적인 이름을 기억해야 하는 경우, 이러한 함수는 사용자의 LTM에 저장되어야 하므로 힘든 정신 활동이 될 수 있다.
- 어떤 연산들은 작업 기억 공간에 부담을 주기 때문에 힘든 일이 될 수도 있다.

#### 보조 표기법(secondary notation)

- 보조 표기법 차원은 프로그래머가 공식 규격에는 없는 의미를 코드에 추가할 가능성을 나타낸다.
- 보조 표기법의 가장 일반적인 예는 `소스 코드에 주석문을 추가할 가능성`이다.

#### 추상화(abstraction)

- 추상화 차원은 시스템의 사용자가 기본적으로 제공되는 추상화만큼 강력한 추상화를 만들 수 있는지 여부다.
- 대부분의 프로그래밍 언어가 허용하는 추상화의 예로는 함수, 객체, 클래스를 만드는 것이다.
- 사용자가 함수를 만들 수 있다는 사실은 사용자가 자신만의 구성 요소로 언어를 형성하고 자신만의 추상화를 추가할 수 있다는 것을 의미한다.

#### 가시성(visibility)

- 가시성은 시스템의 다른 부분을 얼마나 쉽게 볼 수 있는지를 나타낸다.

### 12.1.2 코드베이스 개선을 위해 CDCB 사용

### 12.1.3 설계 기동 및 트레이드오프

- 코드베이스에서 특정 차원을 개선하기 위해 코드베이스를 변경하는 것을 설계 기동(design maneuver)이라고 한다.
  - 코드베이스에 `타입`을 추가하는 것은 `오류 경향성`을 개선하기 위한 설계 기동이다.
  - `함수 이름`을 코드의 영역에 더 부합하도록 변경하는 것은 `매핑 근접성`을 개선하는 설계 기동이다.
- 설계 기동(한 차원의 개선)으로 인해 다른 차원이 변경되는 경우가 많다.

#### 오류 경향성 vs 점도

- 라이브러리나 프레임워크의 사용자가 실수하지 않도록 하기 위해 사용자가 추가 정보를 입력하도록 하는 경우가 많다.
  - 타입 추가. 하지만 타입 추가는 점도가 늘어난다.

#### 잠정성 및 점진적 평가 vs 오류 경향성

- 잠정성과 점진적 평가가 높은 시스템에서는 미완성되거나 불완전한 코드라도 스케치하고 실행할 수 있다. 하지만 불완전한 프로그래램이 개선되지 않은 채 남아 있어 이해하기 어렵고 디버깅하기 어려운 코드로 이어져 오휴 경향성에 영향을 미칠 수 있다.

#### 역할 표현력 vs 분산성

- 명명된 매개변수 같은 문법 요소를 추가하면 역할 표현력이 개선될 수 있지만 추가적인 레이블로 인해 코드가 길어진다.

## 12.2 차원 및 활동

- 5가지 활동: 검색, 이해, 전사, 증가, 탐구

### 12.2.1 차원이 활동에 미치는 영향

- 활동들이 차원과 상호작용한다.
- 어떤 활동은 특정 차원이 높아야 하는 반면, 어떤 활동은 특정 차원이 낮을 때 가장 잘 작동한다.

#### 검색

- `보조 표기법`은 검색에 도움이 되는데 주석문 및 변수 이름은 정보를 찾을 수 있는 위치를 나타낸다.
- `숨겨진 종속성`은 검색 활동에 악영향을 미친다.
- `분산성`은 코드를 더 길게 만들고 검색할 코드가 더 많기 때문에 검색에 부정적인 영향을 준다.

#### 이해

- `역할 표현력`은 변수 및 기타 개체의 유형과 역할이 명확하면 이해하기가 더 쉬워질 수 있다.
- 코드베이스의 `가시성`이 낮으면 클래스와 기능이 서로 어떻게 관련되는지 어렵기 때문에 이해에 부정적인 영향을 준다.

#### 전사

- 전사할 때(미리 정의된 계획을 기반으로 기능을 구현할 때) `일관성` 같은 일부 차원이 나바질 수 있따. 일관된 코드베잉스는 이해하기 쉽지만, 새로운 기능을 구현할 때는 코드베이스에 맞춰야 하므로 정신적 노력이 추가로 필요할 수 있다.

#### 증가

- 코드베이스에 새 기능을 추가할 때 가장 도ㅗ움이 되는 것은 도메인에 대한 `매핑 근접성`이다.
- `점도`가 높은 코드베이스에는 코드를 추가하기가 어렵다.

#### 탐구

- 새로운 설계 아이디어를 탐구할 때 가장 도움이 되는 차원은 `잠정성`과 `점진적 평가`다.

| 차원           | 돕는 활동 | 악영향을 미치는 활동 |
| -------------- | --------- | -------------------- |
| 오류 경향성    |           | 증가                 |
| 분선성         | 검색      |                      |
| 숨겨진 의존성  |           | 검색                 |
| 잠정성         | 탐구      |                      |
| 점도           |           | 전사, 증가           |
| 점진적 평가    | 탐구      |                      |
| 역할 표현력    | 이해      |                      |
| 매핑 근접성    | 증가      |                      |
| 힘든 정신 활동 |           | 전사, 증가, 탐구     |
| 보조 표기법    | 검색      |                      |
| 추상화         | 이해      | 탐구                 |
| 가시성         |           | 이해                 |

### 12.2.2 예상 활동에 대한 코드베이스 최적화

- 코드베이스에 대해 다른 사람이 어떤 작업을 수행할지 이해하고 있어야 한다.
- 코드베이스가 유지되는 동안에는 코드베이스에 대해 일어날 가능성이 가장 높은 활동에 맞는 설계 기동이 필요할 수 있다.
  - 상대적으로 오래되고 안정적인 라이브러리는 증가 활동보다는 `검색` 활동이 더 많이 일어날 가능성이 높다.
  - 새로운 앱은 `증가` 및 `전사` 활동이 일어날 가능성이 더 높다.

## 요약

- CDN은 프로그래밍 언어의 사용자들에게 미칠 인지적 영향을 예측하는 데 도움이 되는 프레임워크이다.
- CDCB는 코드베이스, 라이브러리, 프레임워크가 사용자에게 미치는 영향을 이해하느 데 도움이 되는 CDN의 확장판이다.
- 대부분의 경우 다른 차원 간의 트레이드오프가 이루어져야 한다. 한 차원을 개선하면 다른 차원이 감소할 수 있다.
- 설계 기동을 통해 프레임워크의 인지 차원에 따라 기존 코드베이스의 설계를 개선하는 것이 이뤄질 수 있다.
- 코드베이스가 최적화할 대상인 차원에 대한 요구 사항은 수행하려는 황동에 따라 다르다.

## 퀴즈퀴즈

- 새로운 앱을 개발하는 경우 집중해야 하는 차원은 어디인가?
- 역할 표현력이 높아질 때 상대적으로 나빠지는 차원은 어디인가?
